"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.TONClientError = exports.TONContractExitCode = exports.TONErrorCode = exports.TONErrorSource = exports.emptyTONErrorData = void 0;

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var emptyTONErrorData = {
  core_version: '',
  config_server: '',
  query_url: ''
};
exports.emptyTONErrorData = emptyTONErrorData;
var TONErrorSource = {
  CLIENT: 'client',
  NODE: 'node'
};
exports.TONErrorSource = TONErrorSource;
var TONErrorCode = {
  CLIENT_IS_NOT_SETUP: 1000,
  SEND_NODE_REQUEST_FAILED: 1001,
  MESSAGE_ALREADY_EXPIRED: 1001,
  RUN_LOCAL_ACCOUNT_DOES_NOT_EXISTS: 1002,
  WAIT_FOR_TIMEOUT: 1003,
  INTERNAL_ERROR: 1004,
  QUERY_FAILED: 1005,
  MESSAGE_EXPIRED: 1006,
  SERVER_DOESNT_SUPPORT_AGGREGATIONS: 1007,
  INVALID_CONS: 1008,
  ADDRESS_REQUIRED_FOR_RUN_LOCAL: 1009,
  NETWORK_SILENT: 1010,
  TRANSACTION_LAG: 1011,
  TRANSACTION_WAIT_TIMEOUT: 1012,
  CLOCK_OUT_OF_SYNC: 1013,
  ACCOUNT_MISSING: 1014,
  ACCOUNT_CODE_MISSING: 1015,
  ACCOUNT_BALANCE_TOO_LOW: 1016,
  ACCOUNT_FROZEN_OR_DELETED: 1017,
  // Crypto
  SIGNING_SOURCE_IS_NOT_SPECIFIED: 2021,
  INVALID_CRYPTO_BOX_PARAMS: 2030,
  // Contracts
  CONTRACT_EXECUTION_FAILED: 3025,
  // Queries
  QUERY_FORCIBLY_ABORTED: 4005
};
exports.TONErrorCode = TONErrorCode;
var TONContractExitCode = {
  REPLAY_PROTECTION: 52,
  MESSAGE_EXPIRED: 57,
  NO_GAS: 13
};
exports.TONContractExitCode = TONContractExitCode;

var TONClientError = /*#__PURE__*/function () {
  function TONClientError(code, message, data, source) {
    _classCallCheck(this, TONClientError);

    _defineProperty(this, "message", void 0);

    _defineProperty(this, "source", void 0);

    _defineProperty(this, "code", void 0);

    _defineProperty(this, "data", void 0);

    this.code = code;
    this.message = message;
    this.data = data;
    this.source = source || TONErrorSource.CLIENT;
  } // Testers


  _createClass(TONClientError, null, [{
    key: "isClientError",
    value: function isClientError(error, code) {
      return error.source === TONErrorSource.CLIENT && error.code === code;
    }
  }, {
    key: "isNodeError",
    value: function isNodeError(error, code) {
      return error.source === TONErrorSource.NODE && error.code === code;
    }
  }, {
    key: "isContractError",
    value: function isContractError(error, exitCode) {
      return error.source === TONErrorSource.NODE && error.code === TONErrorCode.CONTRACT_EXECUTION_FAILED && error.data && error.data.exit_code === exitCode;
    }
  }, {
    key: "isOriginalContractError",
    value: function isOriginalContractError(error, exitCode) {
      var _error$data;

      return TONClientError.isContractError(error, exitCode) && !((_error$data = error.data) === null || _error$data === void 0 ? void 0 : _error$data.original_error);
    }
  }, {
    key: "isResolvedContractErrorAfterExpire",
    value: function isResolvedContractErrorAfterExpire(error, exitCode) {
      return TONClientError.isContractError(error, exitCode) && error.data && error.data.original_error && TONClientError.isMessageExpired(error.data.original_error);
    }
  }, {
    key: "isMessageExpired",
    value: function isMessageExpired(error) {
      return TONClientError.isClientError(error, TONErrorCode.MESSAGE_EXPIRED);
    }
  }, {
    key: "isWaitForTimeout",
    value: function isWaitForTimeout(error) {
      return TONClientError.isClientError(error, TONErrorCode.WAIT_FOR_TIMEOUT);
    } // Builders

  }, {
    key: "internalError",
    value: function internalError(message, data) {
      return new TONClientError(TONErrorCode.INTERNAL_ERROR, "Internal error: ".concat(message), data);
    }
  }, {
    key: "invalidCons",
    value: function invalidCons(data) {
      return new TONClientError(TONErrorCode.INVALID_CONS, 'Invalid CONS structure. Each CONS item must contains of two elements.', data);
    }
  }, {
    key: "sendNodeRequestFailed",
    value: function sendNodeRequestFailed(responseText, data) {
      return new TONClientError(TONErrorCode.SEND_NODE_REQUEST_FAILED, "Send node request failed: ".concat(responseText), data);
    }
  }, {
    key: "runLocalAccountDoesNotExists",
    value: function runLocalAccountDoesNotExists(functionName, address, data) {
      return new TONClientError(TONErrorCode.RUN_LOCAL_ACCOUNT_DOES_NOT_EXISTS, "[".concat(functionName, "] run local failed: account [").concat(address, "] does not exists"), data);
    }
  }, {
    key: "waitForTimeout",
    value: function waitForTimeout(data) {
      return new TONClientError(TONErrorCode.WAIT_FOR_TIMEOUT, 'Wait for operation rejected on timeout', data);
    }
  }, {
    key: "queryFailed",
    value: function queryFailed(errors, data) {
      return new TONClientError(TONErrorCode.QUERY_FAILED, "Query failed: ".concat(errors.map(function (x) {
        return x.message || x.toString();
      }).join('\n')), data);
    }
  }, {
    key: "formatTime",
    value: function formatTime(time) {
      if (time) {
        return "".concat(new Date(time * 1000).toISOString(), " (").concat(time, ")");
      }

      return null;
    }
  }, {
    key: "messageExpired",
    value: function messageExpired(data) {
      return new TONClientError(TONErrorCode.MESSAGE_EXPIRED, 'Message expired', _objectSpread(_objectSpread({}, data), {}, {
        sending_time: TONClientError.formatTime(data.sending_time),
        expiration_time: TONClientError.formatTime(data.expire),
        block_time: TONClientError.formatTime(data.block_time)
      }), TONErrorSource.CLIENT);
    }
  }, {
    key: "serverDoesntSupportAggregations",
    value: function serverDoesntSupportAggregations(data) {
      return new TONClientError(TONErrorCode.SERVER_DOESNT_SUPPORT_AGGREGATIONS, 'Server doesn\'t support aggregations', data);
    }
  }, {
    key: "addressRequiredForRunLocal",
    value: function addressRequiredForRunLocal(data) {
      return new TONClientError(TONErrorCode.ADDRESS_REQUIRED_FOR_RUN_LOCAL, 'Address required for run local. You haven\'t specified contract code or data ' + 'so address is required to load missing parts from network.', data);
    }
  }, {
    key: "networkSilent",
    value: function networkSilent(data) {
      return new TONClientError(TONErrorCode.NETWORK_SILENT, 'Network silent: no blocks produced during timeout.', _objectSpread(_objectSpread({}, data), {}, {
        sending_time: TONClientError.formatTime(data.sending_time),
        expiration_time: TONClientError.formatTime(data.expire)
      }));
    }
  }, {
    key: "transactionWaitTimeout",
    value: function transactionWaitTimeout(data) {
      return new TONClientError(TONErrorCode.TRANSACTION_WAIT_TIMEOUT, 'Transaction did not produced during specified timeout', _objectSpread(_objectSpread({}, data), {}, {
        sending_time: TONClientError.formatTime(data.sending_time)
      }));
    }
  }, {
    key: "clockOutOfSync",
    value: function clockOutOfSync(data) {
      return new TONClientError(TONErrorCode.CLOCK_OUT_OF_SYNC, 'You local clock is out of sync with the server time. ' + 'It is a critical condition for sending messages to the blockchain. ' + 'Please sync you clock with the internet time.', data);
    }
  }, {
    key: "accountMissing",
    value: function accountMissing(address, data) {
      return new TONClientError(TONErrorCode.ACCOUNT_MISSING, "Account with address [".concat(address, "] doesn't exists. ") + 'You have to prepaid this account to have a positive balance on them and then deploy ' + 'a contract code for this account.' + 'See SDK documentation for detailed instructions.', data);
    }
  }, {
    key: "accountCodeMissing",
    value: function accountCodeMissing(address, balance, data) {
      return new TONClientError(TONErrorCode.ACCOUNT_CODE_MISSING, "Account with address [".concat(address, "] exists but haven't a contract code yet. ") + 'You have to ensure that an account has an enough balance for deploying ' + 'a contract code and then deploy a contract code for this account. ' + "Current account balance is [".concat(balance, "]. ") + 'See SDK documentation for detailed instructions.', data);
    }
  }, {
    key: "accountBalanceTooLow",
    value: function accountBalanceTooLow(address, balance, data) {
      return new TONClientError(TONErrorCode.ACCOUNT_BALANCE_TOO_LOW, "Account with address [".concat(address, "] has too low balance [").concat(balance, "]. ") + 'You have to send some value to account balance from other contract ' + '(e.g. Wallet contract). ' + 'See SDK documentation for detailed instructions.', data);
    }
  }, {
    key: "noBlocks",
    value: function noBlocks(workchain, data) {
      var workchainName = workchain === -1 ? 'masterchain' : "workchain ".concat(workchain);
      return new TONClientError(TONErrorCode.NETWORK_SILENT, "\"No blocks for ".concat(workchainName, " found\"."), data);
    }
  }, {
    key: "invalidBlockchain",
    value: function invalidBlockchain(message, data) {
      return new TONClientError(TONErrorCode.NETWORK_SILENT, message, data);
    }
  }, {
    key: "queryForciblyAborted",
    value: function queryForciblyAborted(data) {
      return new TONClientError(TONErrorCode.QUERY_FORCIBLY_ABORTED, 'GraphQL query was forcibly aborted on timeout.', data);
    }
  }, {
    key: "signingSourceIsNotSpecified",
    value: function signingSourceIsNotSpecified() {
      return new TONClientError('You must provide signing keys or signing box to sign you message.', TONErrorCode.SIGNING_SOURCE_IS_NOT_SPECIFIED);
    }
  }, {
    key: "invalidCryptoBoxParams",
    value: function invalidCryptoBoxParams(encryptedSeedPhrase) {
      return new TONClientError('You must provide a valid encrypted seed phrase to create a core crypto box. ' + "Provided phrase is: ".concat(JSON.stringify(encryptedSeedPhrase), "."), TONErrorCode.INVALID_CRYPTO_BOX_PARAMS);
    }
  }, {
    key: "clientIsNotSetup",
    value: function clientIsNotSetup() {
      return new TONClientError(TONErrorCode.CLIENT_IS_NOT_SETUP, 'TON Client Library isn\'t set up properly', emptyTONErrorData);
    }
  }]);

  return TONClientError;
}();

exports.TONClientError = TONClientError;

_defineProperty(TONClientError, "source", TONErrorSource);

_defineProperty(TONClientError, "code", TONErrorCode);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9UT05DbGllbnRFcnJvci5qcyJdLCJuYW1lcyI6WyJlbXB0eVRPTkVycm9yRGF0YSIsImNvcmVfdmVyc2lvbiIsImNvbmZpZ19zZXJ2ZXIiLCJxdWVyeV91cmwiLCJUT05FcnJvclNvdXJjZSIsIkNMSUVOVCIsIk5PREUiLCJUT05FcnJvckNvZGUiLCJDTElFTlRfSVNfTk9UX1NFVFVQIiwiU0VORF9OT0RFX1JFUVVFU1RfRkFJTEVEIiwiTUVTU0FHRV9BTFJFQURZX0VYUElSRUQiLCJSVU5fTE9DQUxfQUNDT1VOVF9ET0VTX05PVF9FWElTVFMiLCJXQUlUX0ZPUl9USU1FT1VUIiwiSU5URVJOQUxfRVJST1IiLCJRVUVSWV9GQUlMRUQiLCJNRVNTQUdFX0VYUElSRUQiLCJTRVJWRVJfRE9FU05UX1NVUFBPUlRfQUdHUkVHQVRJT05TIiwiSU5WQUxJRF9DT05TIiwiQUREUkVTU19SRVFVSVJFRF9GT1JfUlVOX0xPQ0FMIiwiTkVUV09SS19TSUxFTlQiLCJUUkFOU0FDVElPTl9MQUciLCJUUkFOU0FDVElPTl9XQUlUX1RJTUVPVVQiLCJDTE9DS19PVVRfT0ZfU1lOQyIsIkFDQ09VTlRfTUlTU0lORyIsIkFDQ09VTlRfQ09ERV9NSVNTSU5HIiwiQUNDT1VOVF9CQUxBTkNFX1RPT19MT1ciLCJBQ0NPVU5UX0ZST1pFTl9PUl9ERUxFVEVEIiwiU0lHTklOR19TT1VSQ0VfSVNfTk9UX1NQRUNJRklFRCIsIklOVkFMSURfQ1JZUFRPX0JPWF9QQVJBTVMiLCJDT05UUkFDVF9FWEVDVVRJT05fRkFJTEVEIiwiUVVFUllfRk9SQ0lCTFlfQUJPUlRFRCIsIlRPTkNvbnRyYWN0RXhpdENvZGUiLCJSRVBMQVlfUFJPVEVDVElPTiIsIk5PX0dBUyIsIlRPTkNsaWVudEVycm9yIiwiY29kZSIsIm1lc3NhZ2UiLCJkYXRhIiwic291cmNlIiwiZXJyb3IiLCJleGl0Q29kZSIsImV4aXRfY29kZSIsImlzQ29udHJhY3RFcnJvciIsIm9yaWdpbmFsX2Vycm9yIiwiaXNNZXNzYWdlRXhwaXJlZCIsImlzQ2xpZW50RXJyb3IiLCJyZXNwb25zZVRleHQiLCJmdW5jdGlvbk5hbWUiLCJhZGRyZXNzIiwiZXJyb3JzIiwibWFwIiwieCIsInRvU3RyaW5nIiwiam9pbiIsInRpbWUiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzZW5kaW5nX3RpbWUiLCJmb3JtYXRUaW1lIiwiZXhwaXJhdGlvbl90aW1lIiwiZXhwaXJlIiwiYmxvY2tfdGltZSIsImJhbGFuY2UiLCJ3b3JrY2hhaW4iLCJ3b3JrY2hhaW5OYW1lIiwiZW5jcnlwdGVkU2VlZFBocmFzZSIsIkpTT04iLCJzdHJpbmdpZnkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFTTyxJQUFNQSxpQkFBK0IsR0FBRztBQUMzQ0MsRUFBQUEsWUFBWSxFQUFFLEVBRDZCO0FBRTNDQyxFQUFBQSxhQUFhLEVBQUUsRUFGNEI7QUFHM0NDLEVBQUFBLFNBQVMsRUFBRTtBQUhnQyxDQUF4Qzs7QUFNQSxJQUFNQyxjQUFjLEdBQUc7QUFDMUJDLEVBQUFBLE1BQU0sRUFBRSxRQURrQjtBQUUxQkMsRUFBQUEsSUFBSSxFQUFFO0FBRm9CLENBQXZCOztBQUtBLElBQU1DLFlBQVksR0FBRztBQUN4QkMsRUFBQUEsbUJBQW1CLEVBQUUsSUFERztBQUV4QkMsRUFBQUEsd0JBQXdCLEVBQUUsSUFGRjtBQUd4QkMsRUFBQUEsdUJBQXVCLEVBQUUsSUFIRDtBQUl4QkMsRUFBQUEsaUNBQWlDLEVBQUUsSUFKWDtBQUt4QkMsRUFBQUEsZ0JBQWdCLEVBQUUsSUFMTTtBQU14QkMsRUFBQUEsY0FBYyxFQUFFLElBTlE7QUFPeEJDLEVBQUFBLFlBQVksRUFBRSxJQVBVO0FBUXhCQyxFQUFBQSxlQUFlLEVBQUUsSUFSTztBQVN4QkMsRUFBQUEsa0NBQWtDLEVBQUUsSUFUWjtBQVV4QkMsRUFBQUEsWUFBWSxFQUFFLElBVlU7QUFXeEJDLEVBQUFBLDhCQUE4QixFQUFFLElBWFI7QUFZeEJDLEVBQUFBLGNBQWMsRUFBRSxJQVpRO0FBYXhCQyxFQUFB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SE8sSUFIRyxDQUFQO0FBS0g7OztrREFFb0M7QUFDakMsYUFBTyxJQUFJSCxjQUFKLENBQ0gsbUVBREcsRUFFSDNCLFlBQVksQ0FBQ29CLCtCQUZWLENBQVA7QUFJSDs7OzJDQUU2QnNDLG1CLEVBQXNDO0FBQ2hFLGFBQU8sSUFBSS9CLGNBQUosQ0FDSCwrR0FDeUJnQyxJQUFJLENBQUNDLFNBQUwsQ0FBZUYsbUJBQWYsQ0FEekIsTUFERyxFQUdIMUQsWUFBWSxDQUFDcUIseUJBSFYsQ0FBUDtBQUtIOzs7dUNBRXlCO0FBQ3RCLGFBQU8sSUFBSU0sY0FBSixDQUNIM0IsWUFBWSxDQUFDQyxtQkFEVixFQUVILDJDQUZHLEVBR0hSLGlCQUhHLENBQVA7QUFLSDs7Ozs7Ozs7Z0JBclRRa0MsYyxZQUNPOUIsYzs7Z0JBRFA4QixjLFVBRUszQixZIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBUT05JbnB1dE1lc3NhZ2UsIFRPTk1lc3NhZ2VQcm9jZXNzaW5nU3RhdGUgfSBmcm9tICcuLi90eXBlcyc7XG5cbmV4cG9ydCB0eXBlIFRPTkVycm9yRGF0YSA9IHtcbiAgICBjb3JlX3ZlcnNpb246IHN0cmluZztcbiAgICBjb25maWdfc2VydmVyOiBzdHJpbmc7XG4gICAgcXVlcnlfdXJsOiBzdHJpbmc7XG4gICAgW3N0cmluZ106IGFueTtcbn1cblxuZXhwb3J0IGNvbnN0IGVtcHR5VE9ORXJyb3JEYXRhOiBUT05FcnJvckRhdGEgPSB7XG4gICAgY29yZV92ZXJzaW9uOiAnJyxcbiAgICBjb25maWdfc2VydmVyOiAnJyxcbiAgICBxdWVyeV91cmw6ICcnLFxufTtcblxuZXhwb3J0IGNvbnN0IFRPTkVycm9yU291cmNlID0ge1xuICAgIENMSUVOVDogJ2NsaWVudCcsXG4gICAgTk9ERTogJ25vZGUnLFxufTtcblxuZXhwb3J0IGNvbnN0IFRPTkVycm9yQ29kZSA9IHtcbiAgICBDTElFTlRfSVNfTk9UX1NFVFVQOiAxMDAwLFxuICAgIFNFTkRfTk9ERV9SRVFVRVNUX0ZBSUxFRDogMTAwMSxcbiAgICBNRVNTQUdFX0FMUkVBRFlfRVhQSVJFRDogMTAwMSxcbiAgICBSVU5fTE9DQUxfQUNDT1VOVF9ET0VTX05PVF9FWElTVFM6IDEwMDIsXG4gICAgV0FJVF9GT1JfVElNRU9VVDogMTAwMyxcbiAgICBJTlRFUk5BTF9FUlJPUjogMTAwNCxcbiAgICBRVUVSWV9GQUlMRUQ6IDEwMDUsXG4gICAgTUVTU0FHRV9FWFBJUkVEOiAxMDA2LFxuICAgIFNFUlZFUl9ET0VTTlRfU1VQUE9SVF9BR0dSRUdBVElPTlM6IDEwMDcsXG4gICAgSU5WQUxJRF9DT05TOiAxMDA4LFxuICAgIEFERFJFU1NfUkVRVUlSRURfRk9SX1JVTl9MT0NBTDogMTAwOSxcbiAgICBORVRXT1JLX1NJTEVOVDogMTAxMCxcbiAgICBUUkFOU0FDVElPTl9MQUc6IDEwMTEsXG4gICAgVFJBTlNBQ1RJT05fV0FJVF9USU1FT1VUOiAxMDEyLFxuICAgIENMT0NLX09VVF9PRl9TWU5DOiAxMDEzLFxuICAgIEFDQ09VTlRfTUlTU0lORzogMTAxNCxcbiAgICBBQ0NPVU5UX0NPREVfTUlTU0lORzogMTAxNSxcbiAgICBBQ0NPVU5UX0JBTEFOQ0VfVE9PX0xPVzogMTAxNixcbiAgICBBQ0NPVU5UX0ZST1pFTl9PUl9ERUxFVEVEOiAxMDE3LFxuXG4gICAgLy8gQ3J5cHRvXG5cbiAgICBTSUdOSU5HX1NPVVJDRV9JU19OT1RfU1BFQ0lGSUVEOiAyMDIxLFxuICAgIElOVkFMSURfQ1JZUFRPX0JPWF9QQVJBTVM6IDIwMzAsXG5cbiAgICAvLyBDb250cmFjdHNcblxuICAgIENPTlRSQUNUX0VYRUNVVElPTl9GQUlMRUQ6IDMwMjUsXG5cbiAgICAvLyBRdWVyaWVzXG5cbiAgICBRVUVSWV9GT1JDSUJMWV9BQk9SVEVEOiA0MDA1LFxufTtcblxuZXhwb3J0IGNvbnN0IFRPTkNvbnRyYWN0RXhpdENvZGUgPSB7XG4gICAgUkVQTEFZX1BST1RFQ1RJT046IDUyLFxuICAgIE1FU1NBR0VfRVhQSVJFRDogNTcsXG4gICAgTk9fR0FTOiAxMyxcbn07XG5cbmV4cG9ydCBjbGFzcyBUT05DbGllbnRFcnJvciB7XG4gICAgc3RhdGljIHNvdXJjZSA9IFRPTkVycm9yU291cmNlO1xuICAgIHN0YXRpYyBjb2RlID0gVE9ORXJyb3JDb2RlO1xuXG4gICAgbWVzc2FnZTogc3RyaW5nO1xuICAgIHNvdXJjZTogc3RyaW5nO1xuICAgIGNvZGU6IG51bWJlcjtcbiAgICBkYXRhOiBUT05FcnJvckRhdGE7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgY29kZTogbnVtYmVyLFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGRhdGE6IFRPTkVycm9yRGF0YSxcbiAgICAgICAgc291cmNlPzogc3RyaW5nLFxuICAgICkge1xuICAgICAgICB0aGlzLmNvZGUgPSBjb2RlO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZSB8fCBUT05FcnJvclNvdXJjZS5DTElFTlQ7XG4gICAgfVxuXG4gICAgLy8gVGVzdGVyc1xuXG4gICAgc3RhdGljIGlzQ2xpZW50RXJyb3IoZXJyb3I6IGFueSwgY29kZTogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAoZXJyb3Iuc291cmNlID09PSBUT05FcnJvclNvdXJjZS5DTElFTlQpXG4gICAgICAgICAgICAmJiAoZXJyb3IuY29kZSA9PT0gY29kZSk7XG4gICAgfVxuXG4gICAgc3RhdGljIGlzTm9kZUVycm9yKGVycm9yOiBhbnksIGNvZGU6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gKGVycm9yLnNvdXJjZSA9PT0gVE9ORXJyb3JTb3VyY2UuTk9ERSlcbiAgICAgICAgICAgICYmIChlcnJvci5jb2RlID09PSBjb2RlKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgaXNDb250cmFjdEVycm9yKGVycm9yOiBhbnksIGV4aXRDb2RlOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIChlcnJvci5zb3VyY2UgPT09IFRPTkVycm9yU291cmNlLk5PREUpXG4gICAgICAgICAgICAmJiAoZXJyb3IuY29kZSA9PT0gVE9ORXJyb3JDb2RlLkNPTlRSQUNUX0VYRUNVVElPTl9GQUlMRUQpXG4gICAgICAgICAgICAmJiAoZXJyb3IuZGF0YSAmJiBlcnJvci5kYXRhLmV4aXRfY29kZSA9PT0gZXhpdENvZGUpO1xuICAgIH1cblxuICAgIHN0YXRpYyBpc09yaWdpbmFsQ29udHJhY3RFcnJvcihlcnJvcjogYW55LCBleGl0Q29kZTogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBUT05DbGllbnRFcnJvci5pc0NvbnRyYWN0RXJyb3IoZXJyb3IsIGV4aXRDb2RlKVxuICAgICAgICAgICAgJiYgKCFlcnJvci5kYXRhPy5vcmlnaW5hbF9lcnJvcik7XG4gICAgfVxuXG4gICAgc3RhdGljIGlzUmVzb2x2ZWRDb250cmFjdEVycm9yQWZ0ZXJFeHBpcmUoZXJyb3I6IGFueSwgZXhpdENvZGU6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gVE9OQ2xpZW50RXJyb3IuaXNDb250cmFjdEVycm9yKGVycm9yLCBleGl0Q29kZSlcbiAgICAgICAgICAgICYmIChlcnJvci5kYXRhICYmIGVycm9yLmRhdGEub3JpZ2luYWxfZXJyb3JcbiAgICAgICAgICAgICAgICAmJiBUT05DbGllbnRFcnJvci5pc01lc3NhZ2VFeHBpcmVkKGVycm9yLmRhdGEub3JpZ2luYWxfZXJyb3IpKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgaXNNZXNzYWdlRXhwaXJlZChlcnJvcjogYW55KTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBUT05DbGllbnRFcnJvci5pc0NsaWVudEVycm9yKGVycm9yLCBUT05FcnJvckNvZGUuTUVTU0FHRV9FWFBJUkVEKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgaXNXYWl0Rm9yVGltZW91dChlcnJvcjogYW55KTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBUT05DbGllbnRFcnJvci5pc0NsaWVudEVycm9yKGVycm9yLCBUT05FcnJvckNvZGUuV0FJVF9GT1JfVElNRU9VVCk7XG4gICAgfVxuXG4gICAgLy8gQnVpbGRlcnNcblxuICAgIHN0YXRpYyBpbnRlcm5hbEVycm9yKFxuICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgIGRhdGE6IFRPTkVycm9yRGF0YSxcbiAgICApOiBUT05DbGllbnRFcnJvciB7XG4gICAgICAgIHJldHVybiBuZXcgVE9OQ2xpZW50RXJyb3IoXG4gICAgICAgICAgICBUT05FcnJvckNvZGUuSU5URVJOQUxfRVJST1IsXG4gICAgICAgICAgICBgSW50ZXJuYWwgZXJyb3I6ICR7bWVzc2FnZX1gLFxuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgaW52YWxpZENvbnMoZGF0YTogVE9ORXJyb3JEYXRhKTogVE9OQ2xpZW50RXJyb3Ige1xuICAgICAgICByZXR1cm4gbmV3IFRPTkNsaWVudEVycm9yKFxuICAgICAgICAgICAgVE9ORXJyb3JDb2RlLklOVkFMSURfQ09OUyxcbiAgICAgICAgICAgICdJbnZhbGlkIENPTlMgc3RydWN0dXJlLiBFYWNoIENPTlMgaXRlbSBtdXN0IGNvbnRhaW5zIG9mIHR3byBlbGVtZW50cy4nLFxuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgc2VuZE5vZGVSZXF1ZXN0RmFpbGVkKFxuICAgICAgICByZXNwb25zZVRleHQ6IHN0cmluZyxcbiAgICAgICAgZGF0YTogVE9ORXJyb3JEYXRhLFxuICAgICk6IFRPTkNsaWVudEVycm9yIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUT05DbGllbnRFcnJvcihcbiAgICAgICAgICAgIFRPTkVycm9yQ29kZS5TRU5EX05PREVfUkVRVUVTVF9GQUlMRUQsXG4gICAgICAgICAgICBgU2VuZCBub2RlIHJlcXVlc3QgZmFpbGVkOiAke3Jlc3BvbnNlVGV4dH1gLFxuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgcnVuTG9jYWxBY2NvdW50RG9lc05vdEV4aXN0cyhcbiAgICAgICAgZnVuY3Rpb25OYW1lOiBzdHJpbmcsXG4gICAgICAgIGFkZHJlc3M6IHN0cmluZyxcbiAgICAgICAgZGF0YTogVE9ORXJyb3JEYXRhLFxuICAgICk6IFRPTkNsaWVudEVycm9yIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUT05DbGllbnRFcnJvcihcbiAgICAgICAgICAgIFRPTkVycm9yQ29kZS5SVU5fTE9DQUxfQUNDT1VOVF9ET0VTX05PVF9FWElTVFMsXG4gICAgICAgICAgICBgWyR7ZnVuY3Rpb25OYW1lfV0gcnVuIGxvY2FsIGZhaWxlZDogYWNjb3VudCBbJHthZGRyZXNzfV0gZG9lcyBub3QgZXhpc3RzYCxcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgc3RhdGljIHdhaXRGb3JUaW1lb3V0KGRhdGE6IFRPTkVycm9yRGF0YSkge1xuICAgICAgICByZXR1cm4gbmV3IFRPTkNsaWVudEVycm9yKFxuICAgICAgICAgICAgVE9ORXJyb3JDb2RlLldBSVRfRk9SX1RJTUVPVVQsXG4gICAgICAgICAgICAnV2FpdCBmb3Igb3BlcmF0aW9uIHJlamVjdGVkIG9uIHRpbWVvdXQnLFxuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgcXVlcnlGYWlsZWQoXG4gICAgICAgIGVycm9yczogRXJyb3JbXSxcbiAgICAgICAgZGF0YTogVE9ORXJyb3JEYXRhLFxuICAgICkge1xuICAgICAgICByZXR1cm4gbmV3IFRPTkNsaWVudEVycm9yKFxuICAgICAgICAgICAgVE9ORXJyb3JDb2RlLlFVRVJZX0ZBSUxFRCxcbiAgICAgICAgICAgIGBRdWVyeSBmYWlsZWQ6ICR7ZXJyb3JzLm1hcCh4ID0+IHgubWVzc2FnZSB8fCB4LnRvU3RyaW5nKCkpLmpvaW4oJ1xcbicpfWAsXG4gICAgICAgICAgICBkYXRhLFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHN0YXRpYyBmb3JtYXRUaW1lKHRpbWU6ID9udW1iZXIpOiA/c3RyaW5nIHtcbiAgICAgICAgaWYgKHRpbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBgJHtuZXcgRGF0ZSh0aW1lICogMTAwMCkudG9JU09TdHJpbmcoKX0gKCR7dGltZX0pYDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBzdGF0aWMgbWVzc2FnZUV4cGlyZWQoXG4gICAgICAgIGRhdGE6IFRPTkVycm9yRGF0YSAmIHtcbiAgICAgICAgICAgIG1lc3NhZ2VfaWQ6IHN0cmluZyxcbiAgICAgICAgICAgIHNlbmRpbmdfdGltZTogbnVtYmVyLFxuICAgICAgICAgICAgZXhwaXJlPzogbnVtYmVyLFxuICAgICAgICAgICAgYmxvY2tfdGltZT86IG51bWJlcixcbiAgICAgICAgICAgIGJsb2NrX2lkPzogc3RyaW5nLFxuICAgICAgICB9LFxuICAgICkge1xuICAgICAgICByZXR1cm4gbmV3IFRPTkNsaWVudEVycm9yKFxuICAgICAgICAgICAgVE9ORXJyb3JDb2RlLk1FU1NBR0VfRVhQSVJFRCxcbiAgICAgICAgICAgICdNZXNzYWdlIGV4cGlyZWQnLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC4uLmRhdGEsXG4gICAgICAgICAgICAgICAgc2VuZGluZ190aW1lOiBUT05DbGllbnRFcnJvci5mb3JtYXRUaW1lKGRhdGEuc2VuZGluZ190aW1lKSxcbiAgICAgICAgICAgICAgICBleHBpcmF0aW9uX3RpbWU6IFRPTkNsaWVudEVycm9yLmZvcm1hdFRpbWUoZGF0YS5leHBpcmUpLFxuICAgICAgICAgICAgICAgIGJsb2NrX3RpbWU6IFRPTkNsaWVudEVycm9yLmZvcm1hdFRpbWUoZGF0YS5ibG9ja190aW1lKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBUT05FcnJvclNvdXJjZS5DTElFTlQsXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgc3RhdGljIHNlcnZlckRvZXNudFN1cHBvcnRBZ2dyZWdhdGlvbnMoZGF0YTogVE9ORXJyb3JEYXRhKSB7XG4gICAgICAgIHJldHVybiBuZXcgVE9OQ2xpZW50RXJyb3IoXG4gICAgICAgICAgICBUT05FcnJvckNvZGUuU0VSVkVSX0RPRVNOVF9TVVBQT1JUX0FHR1JFR0FUSU9OUyxcbiAgICAgICAgICAgICdTZXJ2ZXIgZG9lc25cXCd0IHN1cHBvcnQgYWdncmVnYXRpb25zJyxcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgc3RhdGljIGFkZHJlc3NSZXF1aXJlZEZvclJ1bkxvY2FsKGRhdGE6IFRPTkVycm9yRGF0YSkge1xuICAgICAgICByZXR1cm4gbmV3IFRPTkNsaWVudEVycm9yKFxuICAgICAgICAgICAgVE9ORXJyb3JDb2RlLkFERFJFU1NfUkVRVUlSRURfRk9SX1JVTl9MT0NBTCxcbiAgICAgICAgICAgICdBZGRyZXNzIHJlcXVpcmVkIGZvciBydW4gbG9jYWwuIFlvdSBoYXZlblxcJ3Qgc3BlY2lmaWVkIGNvbnRyYWN0IGNvZGUgb3IgZGF0YSAnXG4gICAgICAgICAgICArICdzbyBhZGRyZXNzIGlzIHJlcXVpcmVkIHRvIGxvYWQgbWlzc2luZyBwYXJ0cyBmcm9tIG5ldHdvcmsuJyxcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgc3RhdGljIG5ldHdvcmtTaWxlbnQoXG4gICAgICAgIGRhdGE6IFRPTkVycm9yRGF0YSAmIHtcbiAgICAgICAgICAgIG1lc3NhZ2VfaWQ6IHN0cmluZyxcbiAgICAgICAgICAgIHNlbmRpbmdfdGltZTogbnVtYmVyLFxuICAgICAgICAgICAgZXhwaXJlOiBudW1iZXIsXG4gICAgICAgICAgICB0aW1lb3V0OiBudW1iZXIsXG4gICAgICAgICAgICBibG9ja19pZD86IHN0cmluZyxcbiAgICAgICAgICAgIG1lc3NhZ2VfcHJvY2Vzc2luZ19zdGF0ZT86IFRPTk1lc3NhZ2VQcm9jZXNzaW5nU3RhdGUsXG4gICAgICAgIH0sXG4gICAgKSB7XG4gICAgICAgIHJldHVybiBuZXcgVE9OQ2xpZW50RXJyb3IoXG4gICAgICAgICAgICBUT05FcnJvckNvZGUuTkVUV09SS19TSUxFTlQsXG4gICAgICAgICAgICAnTmV0d29yayBzaWxlbnQ6IG5vIGJsb2NrcyBwcm9kdWNlZCBkdXJpbmcgdGltZW91dC4nLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC4uLmRhdGEsXG4gICAgICAgICAgICAgICAgc2VuZGluZ190aW1lOiBUT05DbGllbnRFcnJvci5mb3JtYXRUaW1lKGRhdGEuc2VuZGluZ190aW1lKSxcbiAgICAgICAgICAgICAgICBleHBpcmF0aW9uX3RpbWU6IFRPTkNsaWVudEVycm9yLmZvcm1hdFRpbWUoZGF0YS5leHBpcmUpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgdHJhbnNhY3Rpb25XYWl0VGltZW91dChcbiAgICAgICAgZGF0YTogVE9ORXJyb3JEYXRhICYge1xuICAgICAgICAgICAgbWVzc2FnZV9pZDogc3RyaW5nLFxuICAgICAgICAgICAgc2VuZGluZ190aW1lOiBudW1iZXIsXG4gICAgICAgICAgICB0aW1lb3V0OiBudW1iZXIsXG4gICAgICAgICAgICBtZXNzYWdlX3Byb2Nlc3Npbmdfc3RhdGU/OiBUT05NZXNzYWdlUHJvY2Vzc2luZ1N0YXRlLFxuICAgICAgICB9LFxuICAgICkge1xuICAgICAgICByZXR1cm4gbmV3IFRPTkNsaWVudEVycm9yKFxuICAgICAgICAgICAgVE9ORXJyb3JDb2RlLlRSQU5TQUNUSU9OX1dBSVRfVElNRU9VVCxcbiAgICAgICAgICAgICdUcmFuc2FjdGlvbiBkaWQgbm90IHByb2R1Y2VkIGR1cmluZyBzcGVjaWZpZWQgdGltZW91dCcsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgICAgICAgICBzZW5kaW5nX3RpbWU6IFRPTkNsaWVudEVycm9yLmZvcm1hdFRpbWUoZGF0YS5zZW5kaW5nX3RpbWUpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgY2xvY2tPdXRPZlN5bmMoZGF0YTogVE9ORXJyb3JEYXRhKSB7XG4gICAgICAgIHJldHVybiBuZXcgVE9OQ2xpZW50RXJyb3IoXG4gICAgICAgICAgICBUT05FcnJvckNvZGUuQ0xPQ0tfT1VUX09GX1NZTkMsXG4gICAgICAgICAgICAnWW91IGxvY2FsIGNsb2NrIGlzIG91dCBvZiBzeW5jIHdpdGggdGhlIHNlcnZlciB0aW1lLiAnXG4gICAgICAgICAgICArICdJdCBpcyBhIGNyaXRpY2FsIGNvbmRpdGlvbiBmb3Igc2VuZGluZyBtZXNzYWdlcyB0byB0aGUgYmxvY2tjaGFpbi4gJ1xuICAgICAgICAgICAgKyAnUGxlYXNlIHN5bmMgeW91IGNsb2NrIHdpdGggdGhlIGludGVybmV0IHRpbWUuJyxcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgc3RhdGljIGFjY291bnRNaXNzaW5nKFxuICAgICAgICBhZGRyZXNzOiBzdHJpbmcsXG4gICAgICAgIGRhdGE6IFRPTkVycm9yRGF0YSxcbiAgICApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUT05DbGllbnRFcnJvcihcbiAgICAgICAgICAgIFRPTkVycm9yQ29kZS5BQ0NPVU5UX01JU1NJTkcsXG4gICAgICAgICAgICBgQWNjb3VudCB3aXRoIGFkZHJlc3MgWyR7YWRkcmVzc31dIGRvZXNuJ3QgZXhpc3RzLiBgXG4gICAgICAgICAgICArICdZb3UgaGF2ZSB0byBwcmVwYWlkIHRoaXMgYWNjb3VudCB0byBoYXZlIGEgcG9zaXRpdmUgYmFsYW5jZSBvbiB0aGVtIGFuZCB0aGVuIGRlcGxveSAnXG4gICAgICAgICAgICArICdhIGNvbnRyYWN0IGNvZGUgZm9yIHRoaXMgYWNjb3VudC4nXG4gICAgICAgICAgICArICdTZWUgU0RLIGRvY3VtZW50YXRpb24gZm9yIGRldGFpbGVkIGluc3RydWN0aW9ucy4nLFxuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgYWNjb3VudENvZGVNaXNzaW5nKFxuICAgICAgICBhZGRyZXNzOiBzdHJpbmcsXG4gICAgICAgIGJhbGFuY2U6IHN0cmluZyxcbiAgICAgICAgZGF0YTogVE9ORXJyb3JEYXRhLFxuICAgICkge1xuICAgICAgICByZXR1cm4gbmV3IFRPTkNsaWVudEVycm9yKFxuICAgICAgICAgICAgVE9ORXJyb3JDb2RlLkFDQ09VTlRfQ09ERV9NSVNTSU5HLFxuICAgICAgICAgICAgYEFjY291bnQgd2l0aCBhZGRyZXNzIFske2FkZHJlc3N9XSBleGlzdHMgYnV0IGhhdmVuJ3QgYSBjb250cmFjdCBjb2RlIHlldC4gYFxuICAgICAgICAgICAgKyAnWW91IGhhdmUgdG8gZW5zdXJlIHRoYXQgYW4gYWNjb3VudCBoYXMgYW4gZW5vdWdoIGJhbGFuY2UgZm9yIGRlcGxveWluZyAnXG4gICAgICAgICAgICArICdhIGNvbnRyYWN0IGNvZGUgYW5kIHRoZW4gZGVwbG95IGEgY29udHJhY3QgY29kZSBmb3IgdGhpcyBhY2NvdW50LiAnXG4gICAgICAgICAgICArIGBDdXJyZW50IGFjY291bnQgYmFsYW5jZSBpcyBbJHtiYWxhbmNlfV0uIGBcbiAgICAgICAgICAgICsgJ1NlZSBTREsgZG9jdW1lbnRhdGlvbiBmb3IgZGV0YWlsZWQgaW5zdHJ1Y3Rpb25zLicsXG4gICAgICAgICAgICBkYXRhLFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHN0YXRpYyBhY2NvdW50QmFsYW5jZVRvb0xvdyhcbiAgICAgICAgYWRkcmVzczogc3RyaW5nLFxuICAgICAgICBiYWxhbmNlOiBzdHJpbmcsXG4gICAgICAgIGRhdGE6IFRPTkVycm9yRGF0YSxcbiAgICApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUT05DbGllbnRFcnJvcihcbiAgICAgICAgICAgIFRPTkVycm9yQ29kZS5BQ0NPVU5UX0JBTEFOQ0VfVE9PX0xPVyxcbiAgICAgICAgICAgIGBBY2NvdW50IHdpdGggYWRkcmVzcyBbJHthZGRyZXNzfV0gaGFzIHRvbyBsb3cgYmFsYW5jZSBbJHtiYWxhbmNlfV0uIGBcbiAgICAgICAgICAgICsgJ1lvdSBoYXZlIHRvIHNlbmQgc29tZSB2YWx1ZSB0byBhY2NvdW50IGJhbGFuY2UgZnJvbSBvdGhlciBjb250cmFjdCAnXG4gICAgICAgICAgICArICcoZS5nLiBXYWxsZXQgY29udHJhY3QpLiAnXG4gICAgICAgICAgICArICdTZWUgU0RLIGRvY3VtZW50YXRpb24gZm9yIGRldGFpbGVkIGluc3RydWN0aW9ucy4nLFxuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgbm9CbG9ja3MoXG4gICAgICAgIHdvcmtjaGFpbjogbnVtYmVyLFxuICAgICAgICBkYXRhOiBUT05FcnJvckRhdGEsXG4gICAgKSB7XG4gICAgICAgIGNvbnN0IHdvcmtjaGFpbk5hbWUgPSB3b3JrY2hhaW4gPT09IC0xID8gJ21hc3RlcmNoYWluJyA6IGB3b3JrY2hhaW4gJHt3b3JrY2hhaW59YDtcbiAgICAgICAgcmV0dXJuIG5ldyBUT05DbGllbnRFcnJvcihcbiAgICAgICAgICAgIFRPTkVycm9yQ29kZS5ORVRXT1JLX1NJTEVOVCxcbiAgICAgICAgICAgIGBcIk5vIGJsb2NrcyBmb3IgJHt3b3JrY2hhaW5OYW1lfSBmb3VuZFwiLmAsXG4gICAgICAgICAgICBkYXRhLFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHN0YXRpYyBpbnZhbGlkQmxvY2tjaGFpbihcbiAgICAgICAgbWVzc2FnZTogc3RyaW5nLFxuICAgICAgICBkYXRhOiBUT05FcnJvckRhdGEsXG4gICAgKSB7XG4gICAgICAgIHJldHVybiBuZXcgVE9OQ2xpZW50RXJyb3IoVE9ORXJyb3JDb2RlLk5FVFdPUktfU0lMRU5ULCBtZXNzYWdlLCBkYXRhKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgcXVlcnlGb3JjaWJseUFib3J0ZWQoZGF0YTogVE9ORXJyb3JEYXRhKSB7XG4gICAgICAgIHJldHVybiBuZXcgVE9OQ2xpZW50RXJyb3IoXG4gICAgICAgICAgICBUT05FcnJvckNvZGUuUVVFUllfRk9SQ0lCTFlfQUJPUlRFRCxcbiAgICAgICAgICAgICdHcmFwaFFMIHF1ZXJ5IHdhcyBmb3JjaWJseSBhYm9ydGVkIG9uIHRpbWVvdXQuJyxcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgc3RhdGljIHNpZ25pbmdTb3VyY2VJc05vdFNwZWNpZmllZCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUT05DbGllbnRFcnJvcihcbiAgICAgICAgICAgICdZb3UgbXVzdCBwcm92aWRlIHNpZ25pbmcga2V5cyBvciBzaWduaW5nIGJveCB0byBzaWduIHlvdSBtZXNzYWdlLicsXG4gICAgICAgICAgICBUT05FcnJvckNvZGUuU0lHTklOR19TT1VSQ0VfSVNfTk9UX1NQRUNJRklFRCxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgaW52YWxpZENyeXB0b0JveFBhcmFtcyhlbmNyeXB0ZWRTZWVkUGhyYXNlOiBUT05JbnB1dE1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUT05DbGllbnRFcnJvcihcbiAgICAgICAgICAgICdZb3UgbXVzdCBwcm92aWRlIGEgdmFsaWQgZW5jcnlwdGVkIHNlZWQgcGhyYXNlIHRvIGNyZWF0ZSBhIGNvcmUgY3J5cHRvIGJveC4gJ1xuICAgICAgICAgICAgKyBgUHJvdmlkZWQgcGhyYXNlIGlzOiAke0pTT04uc3RyaW5naWZ5KGVuY3J5cHRlZFNlZWRQaHJhc2UpfS5gLFxuICAgICAgICAgICAgVE9ORXJyb3JDb2RlLklOVkFMSURfQ1JZUFRPX0JPWF9QQVJBTVMsXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgc3RhdGljIGNsaWVudElzTm90U2V0dXAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgVE9OQ2xpZW50RXJyb3IoXG4gICAgICAgICAgICBUT05FcnJvckNvZGUuQ0xJRU5UX0lTX05PVF9TRVRVUCxcbiAgICAgICAgICAgICdUT04gQ2xpZW50IExpYnJhcnkgaXNuXFwndCBzZXQgdXAgcHJvcGVybHknLFxuICAgICAgICAgICAgZW1wdHlUT05FcnJvckRhdGEsXG4gICAgICAgICk7XG4gICAgfVxufVxuIl19